# Railway Configuration
# Documentation: https://docs.railway.app/deploy/config-as-code

[build]
builder = "NIXPACKS"

[deploy]
startCommand = "node scripts/dashboard-server.js"
healthcheckPath = "/health"
healthcheckTimeout = 100
restartPolicyType = "ON_FAILURE"
restartPolicyMaxRetries = 10

# Environment Variables (set in Railway dashboard)
# - OPENAI_API_KEY
# - APOLLO_API_KEY
# - SMTP_HOST, SMTP_USER, SMTP_PASS
# - DATABASE_URL (if using PostgreSQL later)

# Automated Tasks
[tasks.followups]
# Send automated follow-ups daily at 9 AM EST
# Runs independently of main server
cron = "0 9 * * *"
command = "node cron/process-follow-ups.js --live"

[tasks.metrics]
# Update metrics every hour
cron = "0 * * * *"
command = "node scripts/update-metrics.js"

# Service Configuration
[service]
name = "caesars-legions-backend"

# Health Check Endpoint
# GET /health should return 200 OK
